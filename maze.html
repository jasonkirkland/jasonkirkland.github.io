<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gyroscope Maze</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body>
  <script>
    let ball;
    let maze;
    let mazeWidth = 300;
    let mazeHeight = 500;

    function setup() {
      createCanvas(mazeWidth, mazeHeight);
      ball = new Ball(width / 2, height / 2, 15);
      maze = new Maze();
      
      if (window.DeviceOrientationEvent) {
        window.addEventListener('deviceorientation', handleOrientation);
      } else {
        alert('Your device does not support the Gyroscope API.');
      }
    }

    function draw() {
      background(220);
      maze.display();
      ball.update();
      ball.display();
    }

    function handleOrientation(event) {
      let x = map(event.gamma, -90, 90, -1, 1);
      let y = map(event.beta, -180, 180, -1, 1);
      ball.applyForce(x, y);
    }

    class Ball {
      constructor(x, y, r) {
        this.pos = createVector(x, y);
        this.vel = createVector();
        this.acc = createVector();
        this.r = r;
      }

      applyForce(x, y) {
        this.acc.x = x;
        this.acc.y = y;
      }

      update() {
        this.vel.add(this.acc);
        this.pos.add(this.vel);
        this.vel.mult(0.95);
        this.acc.mult(0);
        this.checkBounds();
      }

      display() {
        fill(255, 0, 0);
        noStroke();
        ellipse(this.pos.x, this.pos.y, this.r * 2);
      }

      checkBounds() {
        if (this.pos.x < this.r || this.pos.x > width - this.r) {
          this.vel.x *= -1;
        }

        if (this.pos.y < this.r || this.pos.y > height - this.r) {
          this.vel.y *= -1;
        }
      }
    }

    class Maze {
      constructor() {
        // Customize your maze design by adding or modifying the rectangles
        this.walls = [
          { x: 50, y: 50, w: 200, h: 20 },
          { x: 50, y: 150, w: 200, h: 20 },
          { x: 50, y: 250, w: 200, h: 20 },
          { x: 50, y: 350, w: 200, h: 20 },
          { x: 50, y: 450, w: 200, h: 20 }
        ];
      }

      display() {
        fill(0);
        this.walls.forEach(wall => {
          rect(wall.x, wall.y, wall.w, wall.h);
        });
      }
    }
  </script>
</body>
</html>
