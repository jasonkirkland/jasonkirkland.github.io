<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Device Orientation Ball Movement</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 0;
        overflow: hidden;
      }
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <button onclick="requestDeviceOrientation()">Enable Device Orientation</button>
    <canvas id="myCanvas"></canvas>

    <script>
      const canvas = document.getElementById("myCanvas");
      const ctx = canvas.getContext("2d");
      let ballX = window.innerWidth / 2;
      let ballY = window.innerHeight / 2;
      let ballRadius = 15;

      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      function handleOrientation(event) {
        let x = map(event.gamma, -90, 90, -5, 5);
        let y = map(event.beta, -180, 180, -5, 5);
        ballX += x;
        ballY += y;
        drawBall();
      }

      function drawBall() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.arc(ballX, ballY, ballRadius, 0, Math.PI * 2);
        ctx.fillStyle = "red";
        ctx.fill();
        ctx.closePath();
      }

      function requestDeviceOrientation() {
        if (typeof DeviceOrientationEvent !== "undefined" && typeof DeviceOrientationEvent.requestPermission === "function") {
          DeviceOrientationEvent.requestPermission()
            .then((permissionState) => {
              if (permissionState === "granted") {
                window.addEventListener("deviceorientation", handleOrientation);
              }
            })
            .catch(console.error);
        } else {
          // handle regular non iOS 13+ devices
          console.log("not iOS");
          window.addEventListener("deviceorientation", handleOrientation);
        }
      }

      function map(value, start1, stop1, start2, stop2) {
        return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
      }

      drawBall();
    </script>
  </body>
</html>
